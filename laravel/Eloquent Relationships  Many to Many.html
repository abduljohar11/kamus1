<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Eloquent Relationships : Many to Many</title>
    <style>
        body { font-family: 'Segoe UI', system-ui, sans-serif; line-height: 1.8; color: #334155; background: #f8fafc; margin: 0; padding: 40px 20px; }
        .container { max-width: 850px; margin: 0 auto; }
        .btn-back { display: inline-block; margin-bottom: 20px; color: #3b82f6; text-decoration: none; font-weight: bold; font-size: 0.9rem; }
        .materi-card { background: #fff; padding: 45px; border-radius: 16px; border: 1px solid #e2e8f0; box-shadow: 0 4px 6px rgba(0,0,0,0.05); }
        h1 { font-size: 2.5rem; color: #0f172a; margin-top: 0; border-bottom: 4px solid #3b82f6; padding-bottom: 10px; }
        h3 { margin-top: 35px; color: #1e293b; font-size: 1.5rem; border-left: 5px solid #3b82f6; padding-left: 15px; }
        pre { background: #1e1e2e; color: #f8f8f2; padding: 20px; border-radius: 12px; overflow-x: auto; margin: 25px 0; }
        code { font-family: 'Consolas', monospace; background: #fee2e2; color: #991b1b; padding: 2px 6px; border-radius: 4px; font-size: 0.9em; }
        pre code { background: none; color: inherit; padding: 0; }
        img { max-width: 100%; border-radius: 12px; margin: 30px 0; display: block; border: 1px solid #e2e8f0; }
        blockquote { border-left: 5px solid #3b82f6; background: #eff6ff; padding: 15px 25px; border-radius: 0 10px 10px 0; font-style: italic; margin: 25px 0; }
    </style>
</head>
<body>
    <div class="container">
        <a href="index.html" class="btn-back">← Kembali ke Daftar Isi</a>
        <article class="materi-card">
            <main class="flex-1 min-w-0 lg:ml-80 mr-0 xl:mr-64 transition-all duration-300 pt-10 md:pt-0">
<div class="max-w-full mx-auto px-4 sm:px-6 md:px-8 py-5">
<h1 class="text-3xl font-bold text-neutral-900 dark:text-neutral-100 mb-3">Eloquent Relationships : Many to Many</h1>
<div class="prose lg:prose-lg prose-a:text-blue-500 dark:prose-a:text-blue-400 dark:prose-invert w-full max-w-full">
<div x-data="" x-init="let t=document.querySelector('.table-of-contents'),d=document.querySelector('.toc'),m=document.querySelector('.toc-mobile'),b=document.querySelector('.btn-toc');if(t&amp;&amp;t.querySelectorAll('li').length&gt;0){d.appendChild(t.cloneNode(true));m.appendChild(t.cloneNode(true))}else b?.classList.add('hidden');$nextTick(()=&gt;{document.querySelectorAll(`.prose a[href^='http']`).forEach(a=&gt;{a.href.includes(location.hostname)||(a.target='_blank',a.rel='noopener noreferrer')})})">
</div>
<ul class="table-of-contents">
<li><a href="#content-apa-itu-relasi-many-to-many-">Apa itu Relasi Many to Many ?</a></li>
<li><a href="#content-menyiapkan-table-users-roles-dan-userrole-menggunakan-migration">Menyiapkan Table users, roles dan user_role Menggunakan Migration.</a></li>
<li><a href="#content-mendefinisikan-method-relasi-di-model-user-dan-role">Mendefinisikan Method Relasi di Model User dan Role</a></li>
</ul>
<h3><a aria-hidden="true" class="heading-permalink" href="#content-apa-itu-relasi-many-to-many-" id="content-apa-itu-relasi-many-to-many-" title="Permalink"></a>Apa itu Relasi <code>Many to Many</code> ?</h3>
<p><code>Many-to-many</code> <em>relationships</em> merupakan relasi dimana data di dalam <em>table</em> <strong>A</strong> bisa memiliki banyak <em>data</em> di dalam <em>table</em> <strong>B</strong> dan juga sebaliknya, <em>data</em> di dalam <em>table</em> <strong>B</strong> bisa memiliki banyak <em>data</em> di dalam <em>table</em> <strong>A</strong>.</p>
<p>Disini kita tidak dapat melakukan relasi langsung antara <em>table</em> <strong>A</strong> ke dalam <em>table</em> <strong>B</strong>, oleh sebab itu kita harus memiliki satu <em>table</em> lagi untuk menghubungkan dari kedua <em>table</em> tersebut, biasanya <em>table</em> ini di sebut dengan <code>pivot table</code>. Kurang lebih seperti berikut ini :</p>
<p><a href="https://raw.githubusercontent.com/maulayyacyber/assets-articles/main/laravel-eloquent-relationships/many-to-many.png"><img alt="img" src="https://raw.githubusercontent.com/maulayyacyber/assets-articles/main/laravel-eloquent-relationships/many-to-many.png"/></a></p>
<p>Dari gambar di atas bisa kita lihat bersama-sama, kita memiliki satu <em>table</em> lagi yang bernama <code>user_role</code>, <em>table</em> inilah yang disebut dengan <code>pivot table</code>, dimana akan difungsikan untuk menyimpan <code>id</code> dari masing-masing <em>table</em> yang berhubungan.</p>
<p><em><strong>table <code>user</code></strong></em></p>
<div class="table-responsive"><table>
<thead>
<tr>
<th align="left">id</th>
<th align="left">name</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">1</td>
<td align="left">Fika Ridaul Maulayya</td>
</tr>
<tr>
<td align="left">2</td>
<td align="left">Rizqi Maulana</td>
</tr>
<tr>
<td align="left">3</td>
<td align="left">Yudi Purwanto</td>
</tr>
</tbody>
</table></div>
<p><em><strong>table <code>roles</code></strong></em></p>
<div class="table-responsive"><table>
<thead>
<tr>
<th align="left">id</th>
<th align="left">name</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">1</td>
<td align="left">super admin</td>
</tr>
<tr>
<td align="left">2</td>
<td align="left">admin</td>
</tr>
<tr>
<td align="left">3</td>
<td align="left">user</td>
</tr>
</tbody>
</table></div>
<p><em><strong>table <code>user_role</code> (Pivot Table)</strong></em></p>
<div class="table-responsive"><table>
<thead>
<tr>
<th align="left">user_id</th>
<th align="left">role_id</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">1</td>
<td align="left">1</td>
</tr>
<tr>
<td align="left">1</td>
<td align="left">2</td>
</tr>
<tr>
<td align="left">2</td>
<td align="left">2</td>
</tr>
<tr>
<td align="left">3</td>
<td align="left">1</td>
</tr>
<tr>
<td align="left">3</td>
<td align="left">3</td>
</tr>
</tbody>
</table></div>
<h3><a aria-hidden="true" class="heading-permalink" href="#content-menyiapkan-table-users-roles-dan-userrole-menggunakan-migration" id="content-menyiapkan-table-users-roles-dan-userrole-menggunakan-migration" title="Permalink"></a>Menyiapkan Table <code>users</code>, <code>roles</code> dan <code>user_role</code> Menggunakan Migration.</h3>
<p>Berikut ini <em>schema</em> untuk <em>table</em> <code>users</code>.</p>
<pre><code>public function up(): void
{
    Schema::create('users', function (Blueprint $table) {
        $table-&gt;id();
        $table-&gt;string('name');
        $table-&gt;string('email')-&gt;unique();
        $table-&gt;string('password');
    });
}
</code></pre>
<p>Setelah itu, kita buat <em>schema</em> untuk <em>table</em> <code>roles</code>.</p>
<pre><code>public function up(): void
{
    Schema::create('roles', function (Blueprint $table) {
        $table-&gt;id();
        $table-&gt;string('name');
    });
}
</code></pre>
<p>Terakhir, kita harus buat <em>schema</em> lagi untuk <em>pivot</em> <em>table</em>. <em>Pivot</em> <em>table</em> merupakan <em>table</em> ketiga yang digunakan untuk menyimpan <code>id</code> dari <em>kedua</em> table, yaitu <code>users</code> dan <code>roles</code>.</p>
<pre><code>public function up(): void
{
    Schema::create('user_role', function (Blueprint $table) {
        $table-&gt;foreignId('user_id')-&gt;references('id')-&gt;on('users');
        $table-&gt;foreignId('role_id')-&gt;references('id')-&gt;on('roles');
    });
}
</code></pre>
<p>Di atas kita membuat 2 <em>field</em> foreign <em>key</em> yang mereferensikan ke dalam <em>table</em> <code>users</code> dan <code>roles</code>.</p>
<h3><a aria-hidden="true" class="heading-permalink" href="#content-mendefinisikan-method-relasi-di-model-user-dan-role" id="content-mendefinisikan-method-relasi-di-model-user-dan-role" title="Permalink"></a>Mendefinisikan Method Relasi di Model <code>User</code> dan <code>Role</code></h3>
<p>Untuk membuat relasi <code>Many to Many</code>, maka kita perlu menambahkan <em>method</em> pada kedua <em>model</em>, yaitu <code>User</code> dan <code>Role</code> menggunakan <code>BelongsToMany</code>.</p>
<p><strong>Model <code>User</code></strong></p>
<pre><code>public function roles()
{
    return $this-&gt;belongsToMany(Role::class, 'user_role');
}
</code></pre>
<p>Di atas artinya bahwa <em>model</em> <code>User</code> ini bisa memili banyak data <code>roles</code> dan jika kita perhatikandi atas, kita tambahkan <code>user_role</code> pada <em>parameter</em> kedua. Itu menandakan nama <em>pivot</em> <em>table</em> yang digunakan.</p>
<p><strong>Model <code>Role</code></strong></p>
<pre><code>public function users()
{
    return $this-&gt;belongsToMany(User::class, 'user_role');
}
</code></pre>
<p>Penjelasan sama seperti sebelumnya, yaitu <em>model</em> <code>Role</code> ini bisa memiliki banyak data <code>users</code>.</p>
<p>Sehingga kita bisa memanggil data <code>roles</code> yang dimiliki oleh <code>users</code> menggunakan kode seperti berikut ini.</p>
<pre><code>//mencari data user dengan ID "1"
$user = User::find(1);

//tampilkan semua roles yang terkait dengan data user.
$user-&gt;roles;
</code></pre>
<p>Kita juga bisa memanggil data <code>users</code> dari data <code>role</code>.</p>
<pre><code>//mencari data role dengan ID "1"
$role = Role::find(1);

//tampilkan semua users yang terkait dengan data role.
$role-&gt;users;
</code></pre>
</div>
<!-- Div pembatas dengan content -->
<div class="border-t border-neutral-200 dark:border-neutral-700 mt-8 pt-6">
<div class="flex justify-end">
<a :aria-busy="loading ? 'true' : 'false'" :class="loading ? 'opacity-60 pointer-events-none' : ''" class="inline-flex items-center gap-2 px-6 py-3 bg-red-700 hover:bg-red-800 dark:bg-neutral-600 dark:hover:bg-neutral-700 text-white text-sm font-medium rounded-full transition-colors duration-200" data-id="1573" href="https://santrikoding.com/account/my-courses/laravel-untuk-pemula/1574?version=1.1.0" x-data="lessonComplete(28, '1.1.0', 'https://santrikoding.com/account/my-courses/laravel-untuk-pemula/lesson/completed')" x-on:click.prevent="complete($event)">
 <span x-text="loading ? 'Processing…' : 'Complete &amp; Continue'"></span>
 </a>
</div>
</div>
</div>
</main><aside :class="tocVisible ? 'translate-x-0 opacity-100' : 'translate-x-full opacity-0'" class="hidden xl:block fixed right-0 top-14 bottom-0 w-64 overflow-y-auto border-l border-neutral-200 dark:border-neutral-700/80 bg-white/95 dark:bg-neutral-900 backdrop-blur-sm transition-all duration-300 z-30" x-cloak="">
<!-- Header dengan glass effect -->
<div class="sticky top-0 z-10 bg-white/80 dark:bg-neutral-900/80 backdrop-blur-sm border-b border-neutral-200/50 dark:border-neutral-700/50 px-4 py-4">
<div class="flex items-center justify-between">
<div class="flex items-center gap-2">
<div class="p-1.5 bg-primary/10 rounded-lg">

</div>
<div>
<h3 class="text-sm font-semibold text-neutral-900 dark:text-neutral-100">On This Page</h3>
</div>
</div>

</div>
</div>
<!-- Progress Indicator yang benar-benar visible -->
<div class="px-4 py-3 border-b border-neutral-200/50 dark:border-neutral-700/50" x-data="{
            scrollProgress: 0,
            updateProgress() {
                const scrollTop = window.scrollY;
                const docHeight = document.documentElement.scrollHeight - window.innerHeight;
                this.scrollProgress = docHeight &gt; 0 ? Math.min((scrollTop / docHeight) * 100, 100) : 0;
            }
         }" x-init="updateProgress(); $watch('scrollProgress', () =&gt; {}); window.addEventListener('scroll', () =&gt; updateProgress())">
<div class="flex items-center justify-between text-xs mb-2">
<span class="text-neutral-600 dark:text-neutral-400">Reading Progress</span>
<span class="text-primary font-medium" x-text="Math.round(scrollProgress) + '%'"></span>
</div>
<!-- Progress Bar dengan warna yang kontras -->
<div class="w-full bg-neutral-300 dark:bg-neutral-600 rounded-full h-2 shadow-inner">
<div :style="'width: ' + scrollProgress + '%'" class="bg-gradient-to-r from-emerald-300 to-emerald-600 h-2 rounded-full transition-all duration-300 shadow-sm"></div>
</div>
</div>
<!-- Table of Contents Content -->

<!-- Footer dengan quick actions -->
<div class="sticky bottom-0 bg-white/80 dark:bg-neutral-900/80 backdrop-blur-sm border-t border-neutral-200/50 dark:border-neutral-700/50 p-3">
<div class="flex items-center justify-between text-xs">


</div>
</div>
</aside>
        </article>
    </div>
</body>
</html>